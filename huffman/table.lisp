(in-package :laac.huffman)

(defconstant +CODEWORD_POS+ 0)
(defconstant +LENGTH_POS+ 1)
(defconstant +INDEX_POS+ 2)

;; Table 4.A.1 – Scalefactor Huffman Codebook
;; codeword length index
(defparameter *hcb-sf*
  #2A((#x0 1 60)
      (#x4 3 59)
      (#xA 4 61)
      (#xB 4 58)
      (#xC 4 62)
      (#x1A 5 57)
      (#x1B 5 63)
      (#x38 6 56)
      (#x39 6 64)
      (#x3A 6 55)
      (#x3B 6 65)
      (#x78 7 66)
      (#x79 7 54)
      (#x7A 7 67)
      (#xF6 8 53)
      (#xF7 8 68)
      (#xF8 8 52)
      (#xF9 8 69)
      (#xFA 8 51)
      (#x1F6 9 70)
      (#x1F7 9 50)
      (#x1F8 9 49)
      (#x1F9 9 71)
      (#x3F4 10 72)
      (#x3F5 10 48)
      (#x3F6 10 73)
      (#x3F7 10 47)
      (#x3F8 10 74)
      (#x3F9 10 46)
      (#x7F4 11 76)
      (#x7F5 11 75)
      (#x7F6 11 77)
      (#x7F7 11 78)
      (#x7F8 11 45)
      (#x7F9 11 43)
      (#xFF4 12 44)
      (#xFF5 12 79)
      (#xFF6 12 42)
      (#xFF7 12 41)
      (#xFF8 12 80)
      (#xFF9 12 40)
      (#x1FF4 13 81)
      (#x1FF5 13 39)
      (#x1FF6 13 82)
      (#x1FF7 13 38)
      (#x1FF8 13 83)
      (#x3FF2 14 37)
      (#x3FF3 14 35)
      (#x3FF4 14 85)
      (#x3FF5 14 33)
      (#x3FF6 14 36)
      (#x3FF7 14 34)
      (#x3FF8 14 84)
      (#x3FF9 14 32)
      (#x7FF4 15 87)
      (#x7FF5 15 89)
      (#x7FF6 15 30)
      (#x7FF7 15 31)
      (#xFFF0 16 86)
      (#xFFF1 16 29)
      (#xFFF2 16 26)
      (#xFFF3 16 27)
      (#xFFF4 16 28)
      (#xFFF5 16 24)
      (#xFFF6 16 88)
      (#x1FFEE 17 25)
      (#x1FFEF 17 22)
      (#x1FFF0 17 23)
      (#x3FFE2 18 90)
      (#x3FFE3 18 21)
      (#x3FFE4 18 19)
      (#x3FFE5 18 3)
      (#x3FFE6 18 1)
      (#x3FFE7 18 2)
      (#x3FFE8 18 0)
      (#x7FFD2 19 98)
      (#x7FFD3 19 99)
      (#x7FFD4 19 100)
      (#x7FFD5 19 101)
      (#x7FFD6 19 102)
      (#x7FFD7 19 117)
      (#x7FFD8 19 97)
      (#x7FFD9 19 91)
      (#x7FFDA 19 92)
      (#x7FFDB 19 93)
      (#x7FFDC 19 94)
      (#x7FFDD 19 95)
      (#x7FFDE 19 96)
      (#x7FFDF 19 104)
      (#x7FFE0 19 111)
      (#x7FFE1 19 112)
      (#x7FFE2 19 113)
      (#x7FFE3 19 114)
      (#x7FFE4 19 115)
      (#x7FFE5 19 116)
      (#x7FFE6 19 110)
      (#x7FFE7 19 105)
      (#x7FFE8 19 106)
      (#x7FFE9 19 107)
      (#x7FFEA 19 108)
      (#x7FFEB 19 109)
      (#x7FFEC 19 118)
      (#x7FFED 19 6)
      (#x7FFEE 19 8)
      (#x7FFEF 19 9)
      (#x7FFF0 19 10)
      (#x7FFF1 19 5)
      (#x7FFF2 19 103)
      (#x7FFF3 19 120)
      (#x7FFF4 19 119)
      (#x7FFF5 19 4)
      (#x7FFF6 19 7)
      (#x7FFF7 19 15)
      (#x7FFF8 19 16)
      (#x7FFF9 19 18)
      (#x7FFFA 19 20)
      (#x7FFFB 19 17)
      (#x7FFFC 19 11)
      (#x7FFFD 19 12)
      (#x7FFFE 19 14)
      (#x7FFFF 19 13)))

;; Table 4.A.2 – Spectrum Huffman Codebook 1
(defparameter *codebook1*
  #2A((#x0 1 40)
      (#x11 5 13)
      (#x17 5 31)
      (#x15 5 37)
      (#x12 5 39)
      (#x14 5 41)
      (#x16 5 43)
      (#x13 5 49)
      (#x10 5 67)
      (#x68 7 4)
      (#x72 7 10)
      (#x74 7 12)
      (#x76 7 14)
      (#x6C 7 16)
      (#x61 7 22)
      (#x69 7 28)
      (#x77 7 30)
      (#x6F 7 32)
      (#x64 7 34)
      (#x67 7 36)
      (#x62 7 38)
      (#x65 7 42)
      (#x6D 7 44)
      (#x63 7 46)
      (#x6B 7 48)
      (#x71 7 50)
      (#x70 7 52)
      (#x60 7 58)
      (#x6A 7 64)
      (#x75 7 66)
      (#x73 7 68)
      (#x6E 7 70)
      (#x66 7 76)
      (#x1F1 9 1)
      (#x1EC 9 7)
      (#x1EB 9 15)
      (#x1E1 9 19)
      (#x1F0 9 21)
      (#x1F6 9 23)
      (#x1EA 9 25)
      (#x1F2 9 27)
      (#x1ED 9 29)
      (#x1E6 9 33)
      (#x1E5 9 35)
      (#x1E9 9 45)
      (#x1E4 9 47)
      (#x1E3 9 51)
      (#x1F3 9 53)
      (#x1E7 9 55)
      (#x1EF 9 57)
      (#x1EE 9 59)
      (#x1E2 9 61)
      (#x1E8 9 65)
      (#x1F4 9 69)
      (#x1E0 9 73)
      (#x1F5 9 77)
      (#x1F7 9 79)
      (#x3F5 10 3)
      (#x3F0 10 5)
      (#x3F1 10 9)
      (#x3F4 10 11)
      (#x3F6 10 17)
      (#x3F3 10 63)
      (#x3F7 10 71)
      (#x3F2 10 75)
      (#x7F8 11 0)
      (#x7FD 11 2)
      (#x7F7 11 6)
      (#x7F5 11 8)
      (#x7FC 11 18)
      (#x7F1 11 20)
      (#x7F2 11 24)
      (#x7FB 11 26)
      (#x7FE 11 54)
      (#x7F3 11 56)
      (#x7F0 11 60)
      (#x7FA 11 62)
      (#x7F6 11 72)
      (#x7F9 11 74)
      (#x7FF 11 78)
      (#x7F4 11 80)))

;; Table 4.A.3 – Spectrum Huffman Codebook 2
(defparameter *codebook2*
  #2A((#x0 3 40)
      (#x2 4 67)
      (#x6 5 13)
      (#xA 5 31)
      (#x8 5 37)
      (#x9 5 39)
      (#x7 5 41)
      (#xB 5 43)
      (#xC 5 49)
      (#x23 6 4)
      (#x2D 6 10)
      (#x20 6 12)
      (#x2B 6 14)
      (#x28 6 16)
      (#x1B 6 22)
      (#x2A 6 28)
      (#x2C 6 30)
      (#x27 6 32)
      (#x1A 6 34)
      (#x24 6 36)
      (#x1F 6 38)
      (#x1D 6 42)
      (#x30 6 44)
      (#x1C 6 46)
      (#x1E 6 48)
      (#x29 6 50)
      (#x2F 6 52)
      (#x21 6 58)
      (#x22 6 64)
      (#x31 6 66)
      (#x26 6 68)
      (#x25 6 70)
      (#x2E 6 76)
      (#x6F 7 1)
      (#x70 7 11)
      (#x6E 7 15)
      (#x66 7 19)
      (#x6B 7 25)
      (#x6C 7 29)
      (#x67 7 33)
      (#x64 7 47)
      (#x71 7 55)
      (#x68 7 61)
      (#x65 7 65)
      (#x6A 7 71)
      (#x72 7 73)
      (#x69 7 75)
      (#x6D 7 79)
      (#xEB 8 3)
      (#xEA 8 5)
      (#xE8 8 7)
      (#xF2 8 9)
      (#xE9 8 17)
      (#xF8 8 20)
      (#xE7 8 21)
      (#xF1 8 23)
      (#xEC 8 27)
      (#xF5 8 35)
      (#xEF 8 45)
      (#xF3 8 51)
      (#xF0 8 53)
      (#xF4 8 57)
      (#xE6 8 59)
      (#xF7 8 60)
      (#xEE 8 63)
      (#xED 8 69)
      (#xF6 8 77)
      (#x1F3 9 0)
      (#x1FD 9 2)
      (#x1F7 9 6)
      (#x1FA 9 8)
      (#x1F9 9 18)
      (#x1F4 9 24)
      (#x1F5 9 26)
      (#x1FC 9 54)
      (#x1F2 9 56)
      (#x1F8 9 62)
      (#x1FB 9 72)
      (#x1FE 9 74)
      (#x1FF 9 78)
      (#x1F6 9 80)))

;; Table 4.A.4 – Spectrum Huffman Codebook 3
(defparameter *codebook3*
  #2A((#x0 1 0)
      (#x9 4 1)
      (#xB 4 3)
      (#xA 4 9)
      (#x8 4 27)
      (#x19 5 4)
      (#x18 5 36)
      (#x35 6 10)
      (#x34 6 12)
      (#x37 6 13)
      (#x38 6 28)
      (#x36 6 30)
      (#x39 6 39)
      (#x75 7 31)
      (#x76 7 37)
      (#x74 7 40)
      (#xEF 8 2)
      (#xF0 8 5)
      (#xF2 8 48)
      (#xEE 8 54)
      (#xF1 8 63)
      (#x1EB 9 6)
      (#x1E6 9 7)
      (#x1EF 9 11)
      (#x1E9 9 14)
      (#x1ED 9 15)
      (#x1E7 9 16)
      (#x1EE 9 18)
      (#x1EC 9 21)
      (#x1F2 9 22)
      (#x1F3 9 42)
      (#x1F4 9 43)
      (#x1E8 9 45)
      (#x1F1 9 49)
      (#x1F0 9 57)
      (#x1EA 9 66)
      (#x3F2 10 8)
      (#x3F3 10 17)
      (#x3ED 10 19)
      (#x3F8 10 25)
      (#x3F6 10 29)
      (#x3F1 10 32)
      (#x3EB 10 33)
      (#x3EC 10 34)
      (#x3EF 10 41)
      (#x3EA 10 46)
      (#x3F5 10 51)
      (#x3F7 10 55)
      (#x3F0 10 64)
      (#x3EE 10 67)
      (#x3F4 10 75)
      (#x7F9 11 23)
      (#x7F8 11 24)
      (#x7F4 11 38)
      (#x7F6 11 44)
      (#x7F3 11 52)
      (#x7F5 11 58)
      (#x7F2 11 72)
      (#x7F7 11 76)
      (#xFF8 12 26)
      (#xFF4 12 35)
      (#xFFB 12 50)
      (#xFFC 12 53)
      (#xFF6 12 69)
      (#xFFA 12 70)
      (#xFF5 12 73)
      (#xFF7 12 78)
      (#xFF9 12 79)
      (#x1FFA 13 20)
      (#x1FFC 13 47)
      (#x1FFB 13 60)
      (#x3FFA 14 61)
      (#x3FFC 14 65)
      (#x3FFB 14 68)
      (#x7FFE 15 56)
      (#x7FFD 15 59)
      (#x7FFC 15 71)
      (#x7FFB 15 77)
      (#x7FFA 15 80)
      (#xFFFF 16 62)
      (#xFFFE 16 74)))

;; Table 4.A.5 – Spectrum Huffman Codebook 4
(defparameter *codebook4*
  #2A((#x7 4 0)
      (#x8 4 4)
      (#x1 4 13)
      (#x5 4 27)
      (#x9 4 30)
      (#x4 4 31)
      (#x6 4 36)
      (#x2 4 37)
      (#x3 4 39)
      (#x0 4 40)
      (#x16 5 1)
      (#x18 5 3)
      (#x19 5 9)
      (#x17 5 10)
      (#x15 5 12)
      (#x14 5 28)
      (#x70 7 16)
      (#x6B 7 41)
      (#x69 7 43)
      (#x6E 7 48)
      (#x6A 7 49)
      (#x6F 7 58)
      (#x6D 7 64)
      (#x6C 7 66)
      (#x68 7 67)
      (#xF6 8 2)
      (#xEF 8 5)
      (#xF3 8 7)
      (#xED 8 11)
      (#xE2 8 14)
      (#xF0 8 15)
      (#xF1 8 19)
      (#xEE 8 21)
      (#xE4 8 22)
      (#xF2 8 29)
      (#xE5 8 32)
      (#xF4 8 33)
      (#xE8 8 34)
      (#xE7 8 38)
      (#xE3 8 42)
      (#xEB 8 45)
      (#xE6 8 46)
      (#xF5 8 54)
      (#xEC 8 55)
      (#xEA 8 57)
      (#xE9 8 63)
      (#x1EF 9 6)
      (#x1EE 9 18)
      (#x1F3 9 44)
      (#x1F4 9 50)
      (#x1F0 9 52)
      (#x1F5 9 68)
      (#x1F2 9 70)
      (#x1F1 9 76)
      (#x3F0 10 17)
      (#x3F2 10 23)
      (#x3EF 10 25)
      (#x3F4 10 35)
      (#x3F6 10 47)
      (#x3EC 10 51)
      (#x3F9 10 53)
      (#x3F7 10 59)
      (#x3F3 10 61)
      (#x3F8 10 65)
      (#x3EE 10 69)
      (#x3F1 10 73)
      (#x3ED 10 75)
      (#x3F5 10 79)
      (#x7F8 11 8)
      (#x7FA 11 20)
      (#x7F6 11 24)
      (#x7FD 11 26)
      (#x7FB 11 56)
      (#x7F9 11 60)
      (#x7F4 11 71)
      (#x7F7 11 72)
      (#x7F5 11 77)
      (#x7FE 11 78)
      (#x7FC 11 80)
      (#xFFF 12 62)
      (#xFFE 12 74)))

;; Table 4.A.6 – Spectrum Huffman Codebook 5
(defparameter *codebook5*
  #2A((#x0 1 40)
      (#x8 4 31)
      (#xB 4 39)
      (#xA 4 41)
      (#x9 4 49)
      (#x1A 5 30)
      (#x19 5 32)
      (#x18 5 48)
      (#x1B 5 50)
      (#x70 7 22)
      (#x73 7 38)
      (#x71 7 42)
      (#x72 7 58)
      (#xF0 8 13)
      (#xE8 8 21)
      (#xEC 8 23)
      (#xEA 8 29)
      (#xEE 8 33)
      (#xF2 8 37)
      (#xF3 8 43)
      (#xEF 8 47)
      (#xEB 8 51)
      (#xED 8 57)
      (#xE9 8 59)
      (#xF1 8 67)
      (#x1E8 9 12)
      (#x1EC 9 14)
      (#x1F2 9 20)
      (#x1F0 9 24)
      (#x1EB 9 28)
      (#x1EF 9 34)
      (#x1EE 9 46)
      (#x1E9 9 52)
      (#x1F3 9 56)
      (#x1F1 9 60)
      (#x1ED 9 66)
      (#x1EA 9 68)
      (#x3F1 10 4)
      (#x3E8 10 11)
      (#x3EE 10 15)
      (#x3EF 10 19)
      (#x3EA 10 25)
      (#x3F0 10 36)
      (#x3EB 10 55)
      (#x3ED 10 61)
      (#x3E9 10 65)
      (#x3EC 10 69)
      (#x3F3 10 76)
      (#x3F2 10 77)
      (#x7F4 11 2)
      (#x7E8 11 3)
      (#x7EE 11 5)
      (#x7F9 11 6)
      (#x7F1 11 10)
      (#x7F2 11 16)
      (#x7F3 11 26)
      (#x7EB 11 27)
      (#x7ED 11 35)
      (#x7E9 11 44)
      (#x7EF 11 45)
      (#x7EC 11 53)
      (#x7F6 11 54)
      (#x7F7 11 62)
      (#x7F0 11 64)
      (#x7F8 11 70)
      (#x7EA 11 75)
      (#x7F5 11 78)
      (#xFF7 12 1)
      (#xFF8 12 7)
      (#xFFD 12 9)
      (#xFFA 12 17)
      (#xFF4 12 18)
      (#xFF6 12 63)
      (#xFF9 12 71)
      (#xFFC 12 73)
      (#xFF5 12 74)
      (#xFFB 12 79)
      (#x1FFF 13 0)
      (#x1FFD 13 8)
      (#x1FFC 13 72)
      (#x1FFE 13 80)))

;; Table 4.A.7 – Spectrum Huffman Codebook 6
(defparameter *codebook6*
  #2A((#x8 4 30)
      (#x4 4 31)
      (#x6 4 32)
      (#x2 4 39)
      (#x0 4 40)
      (#x3 4 41)
      (#x7 4 48)
      (#x1 4 49)
      (#x5 4 50)
      (#x32 6 20)
      (#x27 6 21)
      (#x28 6 22)
      (#x26 6 23)
      (#x31 6 24)
      (#x2E 6 29)
      (#x29 6 33)
      (#x2D 6 38)
      (#x2F 6 42)
      (#x2B 6 47)
      (#x2C 6 51)
      (#x30 6 56)
      (#x24 6 57)
      (#x2A 6 58)
      (#x25 6 59)
      (#x33 6 60)
      (#x6C 7 12)
      (#x71 7 13)
      (#x68 7 14)
      (#x6F 7 28)
      (#x6B 7 34)
      (#x72 7 37)
      (#x73 7 43)
      (#x6E 7 46)
      (#x6D 7 52)
      (#x6A 7 66)
      (#x70 7 67)
      (#x69 7 68)
      (#x74 7 69)
      (#xEA 8 11)
      (#xF0 8 15)
      (#xEF 8 19)
      (#xEB 8 25)
      (#xEE 8 55)
      (#xEC 8 61)
      (#xED 8 65)
      (#xF1 8 70)
      (#x1F1 9 2)
      (#x1EB 9 3)
      (#x1F4 9 4)
      (#x1EA 9 5)
      (#x1F0 9 6)
      (#x1E5 9 10)
      (#x1E6 9 16)
      (#x1F3 9 18)
      (#x1F7 9 26)
      (#x1E8 9 27)
      (#x1EE 9 35)
      (#x1EF 9 36)
      (#x1FA 9 44)
      (#x1E7 9 45)
      (#x1EC 9 53)
      (#x1F9 9 54)
      (#x1F2 9 62)
      (#x1E4 9 64)
      (#x1F6 9 74)
      (#x1ED 9 75)
      (#x1F8 9 76)
      (#x1E9 9 77)
      (#x1F5 9 78)
      (#x3FD 10 1)
      (#x3FC 10 7)
      (#x3F6 10 9)
      (#x3F7 10 17)
      (#x3F8 10 63)
      (#x3FA 10 71)
      (#x3F9 10 73)
      (#x3FB 10 79)
      (#x7FE 11 0)
      (#x7FD 11 8)
      (#x7FF 11 72)
      (#x7FC 11 80)))

;; Table 4.A.8 – Spectrum Huffman Codebook 7
(defparameter *codebook7*
  #2A((#x0 1 0)
      (#x5 3 1)
      (#x4 3 8)
      (#xC 4 9)
      (#x37 6 2)
      (#x35 6 10)
      (#x36 6 16)
      (#x34 6 17)
      (#x74 7 3)
      (#x71 7 11)
      (#x72 7 18)
      (#x73 7 24)
      (#x70 7 25)
      (#xF2 8 4)
      (#xEC 8 12)
      (#xEE 8 13)
      (#xEA 8 19)
      (#xF1 8 20)
      (#xEB 8 26)
      (#xF0 8 27)
      (#xF3 8 32)
      (#xED 8 33)
      (#xEF 8 41)
      (#x1EB 9 5)
      (#x1EE 9 14)
      (#x1F5 9 15)
      (#x1E9 9 21)
      (#x1F3 9 22)
      (#x1F1 9 28)
      (#x1F0 9 29)
      (#x1E8 9 34)
      (#x1EF 9 35)
      (#x1ED 9 40)
      (#x1EA 9 42)
      (#x1F2 9 43)
      (#x1EC 9 49)
      (#x1F4 9 50)
      (#x3ED 10 6)
      (#x3F5 10 23)
      (#x3EC 10 30)
      (#x3FA 10 31)
      (#x3EF 10 36)
      (#x3F1 10 37)
      (#x3F9 10 38)
      (#x3F3 10 44)
      (#x3F8 10 45)
      (#x3EE 10 48)
      (#x3F4 10 51)
      (#x3F7 10 52)
      (#x3F0 10 57)
      (#x3F2 10 58)
      (#x3F6 10 59)
      (#x7F7 11 7)
      (#x7FB 11 39)
      (#x7F9 11 46)
      (#x7FC 11 47)
      (#x7F8 11 53)
      (#x7F6 11 56)
      (#x7FA 11 60)
      (#x7FD 11 61)
      (#xFFD 12 54)
      (#xFFE 12 55)
      (#xFFC 12 62)
      (#xFFF 12 63)))

;; Table 4.A.9 – Spectrum Huffman Codebook 8
(defparameter *codebook8*
  #2A((#x0 3 9)
      (#x5 4 1)
      (#x3 4 8)
      (#x4 4 10)
      (#x2 4 17)
      (#x6 4 18)
      (#xE 5 0)
      (#x10 5 2)
      (#x12 5 11)
      (#xF 5 16)
      (#x14 5 19)
      (#x11 5 25)
      (#x13 5 26)
      (#x30 6 3)
      (#x2C 6 12)
      (#x2E 6 20)
      (#x2F 6 24)
      (#x2A 6 27)
      (#x32 6 28)
      (#x2B 6 33)
      (#x2D 6 34)
      (#x31 6 35)
      (#x33 6 42)
      (#x6F 7 4)
      (#x6A 7 13)
      (#x75 7 14)
      (#x69 7 21)
      (#x72 7 22)
      (#x6C 7 29)
      (#x71 7 32)
      (#x6D 7 36)
      (#x70 7 37)
      (#x68 7 41)
      (#x6B 7 43)
      (#x6E 7 44)
      (#x74 7 49)
      (#x73 7 50)
      (#xF1 8 5)
      (#xF8 8 15)
      (#xF5 8 23)
      (#xEC 8 30)
      (#xFA 8 31)
      (#xF2 8 38)
      (#xEF 8 40)
      (#xEE 8 45)
      (#xF9 8 46)
      (#xED 8 51)
      (#xF0 8 52)
      (#xF6 8 53)
      (#xF3 8 57)
      (#xF4 8 58)
      (#xF7 8 59)
      (#x1FA 9 6)
      (#x1F9 9 39)
      (#x1F8 9 48)
      (#x1F6 9 54)
      (#x1FD 9 55)
      (#x1F7 9 60)
      (#x1FB 9 61)
      (#x1FC 9 62)
      (#x3FE 10 7)
      (#x3FC 10 47)
      (#x3FD 10 56)
      (#x3FF 10 63)))

;; Table 4.A.10 – Spectrum Huffman Codebook 9
(defparameter *codebook9*
  #2A((#x0 1 0)
      (#x5 3 1)
      (#x4 3 13)
      (#xC 4 14)
      (#x37 6 2)
      (#x35 6 15)
      (#x36 6 26)
      (#x34 6 27)
      (#x72 7 16)
      (#x71 7 28)
      (#x70 7 40)
      (#xE7 8 3)
      (#xEA 8 17)
      (#xED 8 18)
      (#xE8 8 29)
      (#xEC 8 30)
      (#xE6 8 39)
      (#xE9 8 41)
      (#xEB 8 53)
      (#x1DE 9 4)
      (#x1E2 9 19)
      (#x1E1 9 31)
      (#x1DD 9 42)
      (#x1E3 9 43)
      (#x1DF 9 52)
      (#x1DC 9 54)
      (#x1E6 9 55)
      (#x1E0 9 66)
      (#x1E4 9 67)
      (#x1E5 9 79)
      (#x3CE 10 5)
      (#x3D9 10 6)
      (#x3D1 10 20)
      (#x3D3 10 21)
      (#x3E0 10 22)
      (#x3CF 10 32)
      (#x3DD 10 33)
      (#x3DB 10 34)
      (#x3D2 10 44)
      (#x3DC 10 45)
      (#x3D5 10 56)
      (#x3DE 10 57)
      (#x3D0 10 65)
      (#x3D6 10 68)
      (#x3D7 10 80)
      (#x3D8 10 92)
      (#x3E1 10 93)
      (#x3D4 10 105)
      (#x3DA 10 106)
      (#x3DF 10 118)
      (#x7C8 11 7)
      (#x7CD 11 8)
      (#x7D8 11 23)
      (#x7D0 11 35)
      (#x7CC 11 46)
      (#x7CA 11 47)
      (#x7DE 11 48)
      (#x7CB 11 58)
      (#x7DD 11 59)
      (#x7DC 11 60)
      (#x7C5 11 69)
      (#x7D1 11 70)
      (#x7DB 11 71)
      (#x7E0 11 73)
      (#x7C4 11 78)
      (#x7C6 11 81)
      (#x7CF 11 82)
      (#x7DA 11 83)
      (#x7D3 11 91)
      (#x7D4 11 94)
      (#x7D9 11 95)
      (#x7D2 11 104)
      (#x7C7 11 107)
      (#x7D7 11 108)
      (#x7E2 11 109)
      (#x7E1 11 117)
      (#x7C9 11 119)
      (#x7D6 11 120)
      (#x7CE 11 131)
      (#x7D5 11 132)
      (#x7DF 11 144)
      (#xFC8 12 9)
      (#xFDD 12 10)
      (#xFCF 12 24)
      (#xFD5 12 25)
      (#xFC7 12 36)
      (#xFD4 12 37)
      (#xFE4 12 38)
      (#xFD8 12 49)
      (#xFEA 12 50)
      (#xFCD 12 61)
      (#xFE2 12 62)
      (#xFE7 12 63)
      (#xFD2 12 72)
      (#xFD9 12 74)
      (#xFEB 12 75)
      (#xFCB 12 84)
      (#xFDA 12 85)
      (#xFE3 12 86)
      (#xFE9 12 87)
      (#xFD3 12 96)
      (#xFDE 12 97)
      (#xFCE 12 110)
      (#xFDB 12 111)
      (#xFCA 12 121)
      (#xFD0 12 122)
      (#xFE5 12 123)
      (#xFE6 12 124)
      (#xFE0 12 130)
      (#xFC6 12 133)
      (#xFD1 12 134)
      (#xFE1 12 135)
      (#xFE8 12 143)
      (#xFC9 12 145)
      (#xFD7 12 146)
      (#xFDC 12 147)
      (#xFCC 12 157)
      (#xFD6 12 158)
      (#xFDF 12 159)
      (#x1FE4 13 11)
      (#x1FEC 13 12)
      (#x1FDB 13 51)
      (#x1FE1 13 64)
      (#x1FE3 13 76)
      (#x1FE9 13 77)
      (#x1FE6 13 88)
      (#x1FF3 13 89)
      (#x1FF7 13 90)
      (#x1FDD 13 98)
      (#x1FD9 13 99)
      (#x1FE2 13 100)
      (#x1FEA 13 101)
      (#x1FF1 13 102)
      (#x1FF6 13 103)
      (#x1FD8 13 112)
      (#x1FEE 13 113)
      (#x1FF4 13 115)
      (#x1FEB 13 125)
      (#x1FEF 13 126)
      (#x1FE0 13 136)
      (#x1FE8 13 137)
      (#x1FF0 13 138)
      (#x1FDC 13 148)
      (#x1FDF 13 149)
      (#x1FED 13 150)
      (#x1FF5 13 151)
      (#x1FE7 13 156)
      (#x1FDE 13 160)
      (#x1FDA 13 161)
      (#x1FE5 13 162)
      (#x1FF2 13 163)
      (#x3FF0 14 114)
      (#x3FF2 14 116)
      (#x3FF3 14 127)
      (#x3FF4 14 128)
      (#x3FF5 14 129)
      (#x3FF1 14 139)
      (#x3FF8 14 140)
      (#x3FF6 14 141)
      (#x3FF9 14 152)
      (#x3FFB 14 153)
      (#x3FFA 14 164)
      (#x3FF7 14 165)
      (#x3FFC 14 166)
      (#x3FFD 14 167)
      (#x7FFC 15 142)
      (#x7FFD 15 154)
      (#x7FFE 15 155)
      (#x7FFF 15 168)))

;; Table 4.A.11 – Spectrum Huffman Codebook 10
(defparameter *codebook10*
  #2A((#x0 4 14)
      (#x1 4 15)
      (#x2 4 27)
      (#x8 5 1)
      (#x7 5 13)
      (#x9 5 16)
      (#x6 5 28)
      (#xC 5 29)
      (#xB 5 40)
      (#xA 5 41)
      (#xD 5 42)
      (#x22 6 0)
      (#x1D 6 2)
      (#x26 6 3)
      (#x20 6 17)
      (#x1C 6 26)
      (#x1E 6 30)
      (#x28 6 31)
      (#x25 6 39)
      (#x24 6 43)
      (#x21 6 53)
      (#x1F 6 54)
      (#x23 6 55)
      (#x27 6 56)
      (#x29 6 67)
      (#x5F 7 4)
      (#x54 7 18)
      (#x60 7 19)
      (#x5B 7 32)
      (#x57 7 44)
      (#x61 7 45)
      (#x5D 7 52)
      (#x59 7 57)
      (#x64 7 58)
      (#x55 7 66)
      (#x56 7 68)
      (#x58 7 69)
      (#x62 7 70)
      (#x5E 7 79)
      (#x5A 7 80)
      (#x5C 7 81)
      (#x63 7 82)
      (#xD3 8 5)
      (#xD5 8 20)
      (#xDC 8 21)
      (#xCD 8 33)
      (#xD9 8 34)
      (#xCC 8 46)
      (#xDD 8 47)
      (#xD8 8 59)
      (#xDF 8 60)
      (#xD1 8 65)
      (#xCE 8 71)
      (#xE0 8 72)
      (#xE2 8 73)
      (#xCA 8 83)
      (#xDA 8 84)
      (#xD2 8 92)
      (#xCB 8 93)
      (#xD0 8 94)
      (#xD7 8 95)
      (#xDB 8 96)
      (#xD4 8 105)
      (#xCF 8 106)
      (#xD6 8 107)
      (#xDE 8 108)
      (#xE1 8 109)
      (#x1CF 9 6)
      (#x1D4 9 22)
      (#x1CE 9 35)
      (#x1DC 9 36)
      (#x1CC 9 48)
      (#x1DE 9 49)
      (#x1D2 9 61)
      (#x1E2 9 62)
      (#x1DA 9 74)
      (#x1C9 9 78)
      (#x1C7 9 85)
      (#x1CA 9 86)
      (#x1E0 9 87)
      (#x1E3 9 91)
      (#x1C6 9 97)
      (#x1D5 9 98)
      (#x1D8 9 99)
      (#x1E1 9 104)
      (#x1D0 9 110)
      (#x1D6 9 111)
      (#x1CD 9 118)
      (#x1C8 9 119)
      (#x1CB 9 120)
      (#x1D1 9 121)
      (#x1D7 9 122)
      (#x1DF 9 123)
      (#x1DD 9 131)
      (#x1D3 9 132)
      (#x1D9 9 133)
      (#x1DB 9 134)
      (#x1E4 9 145)
      (#x3D0 10 7)
      (#x3D7 10 8)
      (#x3ED 10 9)
      (#x3CD 10 23)
      (#x3DE 10 24)
      (#x3D9 10 37)
      (#x3F1 10 38)
      (#x3D3 10 50)
      (#x3E7 10 51)
      (#x3DD 10 63)
      (#x3EE 10 64)
      (#x3D4 10 75)
      (#x3E3 10 76)
      (#x3DB 10 88)
      (#x3E8 10 89)
      (#x3CA 10 100)
      (#x3DA 10 101)
      (#x3D1 10 112)
      (#x3D5 10 113)
      (#x3F2 10 114)
      (#x3E9 10 117)
      (#x3CF 10 124)
      (#x3E0 10 125)
      (#x3EF 10 126)
      (#x3EB 10 130)
      (#x3D2 10 135)
      (#x3CC 10 136)
      (#x3DC 10 137)
      (#x3EA 10 138)
      (#x3CE 10 144)
      (#x3CB 10 146)
      (#x3D8 10 147)
      (#x3D6 10 148)
      (#x3E2 10 149)
      (#x3E5 10 150)
      (#x3EC 10 157)
      (#x3DF 10 158)
      (#x3E1 10 159)
      (#x3E4 10 160)
      (#x3E6 10 161)
      (#x3F0 10 162)
      (#x7F0 11 10)
      (#x7F6 11 11)
      (#x7E7 11 25)
      (#x7EB 11 77)
      (#x7EC 11 90)
      (#x7EA 11 102)
      (#x7F1 11 103)
      (#x7EE 11 115)
      (#x7FB 11 116)
      (#x7E6 11 127)
      (#x7F8 11 128)
      (#x7ED 11 139)
      (#x7F3 11 140)
      (#x7F9 11 141)
      (#x7F2 11 143)
      (#x7E8 11 151)
      (#x7F4 11 152)
      (#x7F5 11 153)
      (#x7F7 11 154)
      (#x7FA 11 156)
      (#x7E9 11 163)
      (#x7EF 11 164)
      (#xFFD 12 12)
      (#xFFA 12 129)
      (#xFF9 12 142)
      (#xFFB 12 155)
      (#xFF8 12 165)
      (#xFFE 12 166)
      (#xFFC 12 167)
      (#xFFF 12 168)))

;; Table 4.A.12 – Spectrum Huffman Codebook 11
(defparameter *codebook11*
  #2A((#x0 4 0)
      (#x1 4 18)
      (#x6 5 1)
      (#x5 5 17)
      (#x8 5 19)
      (#x7 5 35)
      (#x9 5 36)
      (#x4 5 288)
      (#x19 6 2)
      (#x14 6 20)
      (#x17 6 34)
      (#x18 6 37)
      (#x15 6 52)
      (#x16 6 53)
      (#x1A 6 54)
      (#x3D 7 3)
      (#x37 7 21)
      (#x42 7 22)
      (#x39 7 38)
      (#x40 7 39)
      (#x3C 7 51)
      (#x3B 7 55)
      (#x44 7 56)
      (#x36 7 69)
      (#x38 7 70)
      (#x3A 7 71)
      (#x41 7 72)
      (#x3E 7 86)
      (#x3F 7 87)
      (#x43 7 88)
      (#x45 7 89)
      (#x9C 8 4)
      (#xC6 8 5)
      (#x92 8 23)
      (#xAF 8 24)
      (#xAE 8 33)
      (#x8E 8 40)
      (#xA3 8 41)
      (#xB8 8 42)
      (#x9D 8 50)
      (#x91 8 57)
      (#xA5 8 58)
      (#xBE 8 59)
      (#x94 8 67)
      (#x9A 8 68)
      (#x8C 8 73)
      (#x9B 8 74)
      (#xB0 8 75)
      (#xC3 8 76)
      (#x93 8 84)
      (#xBF 8 85)
      (#x9E 8 90)
      (#xA7 8 91)
      (#xB9 8 92)
      (#x9F 8 101)
      (#x8F 8 103)
      (#x8D 8 104)
      (#x90 8 105)
      (#x98 8 106)
      (#xA6 8 107)
      (#xB6 8 108)
      (#xC4 8 109)
      (#xA8 8 118)
      (#xAB 8 120)
      (#xA4 8 121)
      (#xAA 8 122)
      (#xB2 8 123)
      (#xC2 8 124)
      (#xC5 8 125)
      (#xAD 8 135)
      (#xBD 8 138)
      (#xBC 8 139)
      (#xB4 8 152)
      (#xB7 8 169)
      (#xBA 8 186)
      (#xC1 8 203)
      (#xB5 8 273)
      (#xA1 8 274)
      (#x96 8 275)
      (#x97 8 276)
      (#x95 8 277)
      (#x99 8 278)
      (#xA0 8 279)
      (#xA2 8 280)
      (#xAC 8 281)
      (#xA9 8 282)
      (#xB1 8 283)
      (#xB3 8 284)
      (#xBB 8 285)
      (#xC0 8 286)
      (#x1A7 9 6)
      (#x191 9 25)
      (#x1A5 9 26)
      (#x1B5 9 27)
      (#x199 9 43)
      (#x1AC 9 44)
      (#x1C1 9 45)
      (#x196 9 60)
      (#x1AE 9 61)
      (#x1B9 9 62)
      (#x19E 9 77)
      (#x1AB 9 78)
      (#x1BC 9 79)
      (#x194 9 93)
      (#x1A2 9 94)
      (#x1BA 9 95)
      (#x1C3 9 96)
      (#x1A0 9 102)
      (#x19F 9 110)
      (#x1AF 9 111)
      (#x1BF 9 112)
      (#x1B6 9 119)
      (#x198 9 126)
      (#x1A4 9 127)
      (#x1B8 9 128)
      (#x192 9 137)
      (#x18E 9 140)
      (#x197 9 141)
      (#x19A 9 142)
      (#x1A3 9 143)
      (#x1B1 9 144)
      (#x1A9 9 154)
      (#x19B 9 155)
      (#x19C 9 156)
      (#x1A1 9 157)
      (#x1AA 9 158)
      (#x1AD 9 159)
      (#x1B3 9 160)
      (#x1BB 9 171)
      (#x1A8 9 172)
      (#x1A6 9 173)
      (#x1B0 9 174)
      (#x1B2 9 175)
      (#x1B7 9 176)
      (#x1BD 9 189)
      (#x1B4 9 190)
      (#x1C4 9 192)
      (#x190 9 220)
      (#x1BE 9 223)
      (#x1C0 9 224)
      (#x195 9 237)
      (#x193 9 254)
      (#x19D 9 271)
      (#x1C2 9 272)
      (#x18F 9 287)
      (#x390 10 7)
      (#x3C2 10 8)
      (#x3DF 10 9)
      (#x38E 10 16)
      (#x39E 10 28)
      (#x3C0 10 29)
      (#x3A2 10 30)
      (#x3CD 10 31)
      (#x3B1 10 46)
      (#x396 10 47)
      (#x3BE 10 48)
      (#x3CA 10 49)
      (#x3A1 10 63)
      (#x391 10 64)
      (#x3A5 10 65)
      (#x3D5 10 66)
      (#x39F 10 80)
      (#x38F 10 81)
      (#x3A9 10 82)
      (#x3CF 10 83)
      (#x3A6 10 97)
      (#x3A7 10 98)
      (#x3BB 10 99)
      (#x3D4 10 100)
      (#x399 10 113)
      (#x3BF 10 114)
      (#x3B4 10 115)
      (#x3C9 10 116)
      (#x3E7 10 117)
      (#x38C 10 129)
      (#x3A4 10 130)
      (#x3C4 10 131)
      (#x3C6 10 132)
      (#x3DD 10 133)
      (#x3E8 10 134)
      (#x3AF 10 136)
      (#x38D 10 145)
      (#x398 10 146)
      (#x3B7 10 147)
      (#x3D3 10 148)
      (#x3D1 10 149)
      (#x3DB 10 150)
      (#x3DE 10 153)
      (#x38B 10 161)
      (#x3B2 10 162)
      (#x3B8 10 163)
      (#x3CE 10 164)
      (#x3E1 10 165)
      (#x3E0 10 166)
      (#x39B 10 177)
      (#x39A 10 178)
      (#x3BA 10 179)
      (#x3B5 10 180)
      (#x3D6 10 181)
      (#x3E4 10 183)
      (#x3A0 10 188)
      (#x38A 10 191)
      (#x392 10 193)
      (#x3AA 10 194)
      (#x3B0 10 195)
      (#x3BC 10 196)
      (#x3D7 10 197)
      (#x3C8 10 205)
      (#x3A3 10 206)
      (#x395 10 207)
      (#x39D 10 208)
      (#x3AC 10 209)
      (#x3AE 10 210)
      (#x3C5 10 211)
      (#x3D8 10 212)
      (#x3E2 10 213)
      (#x3E6 10 214)
      (#x393 10 222)
      (#x394 10 225)
      (#x397 10 226)
      (#x3AD 10 227)
      (#x3C3 10 228)
      (#x3C1 10 229)
      (#x3D2 10 230)
      (#x3BD 10 239)
      (#x39C 10 240)
      (#x3AB 10 241)
      (#x3A8 10 242)
      (#x3B3 10 243)
      (#x3B9 10 244)
      (#x3D0 10 245)
      (#x3E3 10 246)
      (#x3E5 10 247)
      (#x3DC 10 256)
      (#x3B6 10 257)
      (#x3C7 10 258)
      (#x3CC 10 259)
      (#x3CB 10 260)
      (#x3D9 10 261)
      (#x3DA 10 262)
      (#x7E6 11 10)
      (#x7F3 11 11)
      (#x7EC 11 13)
      (#x7D6 11 32)
      (#x7DD 11 151)
      (#x7D2 11 167)
      (#x7E5 11 168)
      (#x7E3 11 170)
      (#x7D7 11 182)
      (#x7D8 11 184)
      (#x7EA 11 185)
      (#x7E8 11 187)
      (#x7D4 11 198)
      (#x7DC 11 199)
      (#x7DB 11 200)
      (#x7D5 11 201)
      (#x7F0 11 202)
      (#x7FB 11 204)
      (#x7E4 11 215)
      (#x7E7 11 216)
      (#x7E0 11 217)
      (#x7E9 11 218)
      (#x7F7 11 219)
      (#x7F2 11 221)
      (#x7DA 11 231)
      (#x7D9 11 232)
      (#x7DF 11 233)
      (#x7EB 11 234)
      (#x7F4 11 235)
      (#x7FA 11 236)
      (#x7F8 11 238)
      (#x7E2 11 248)
      (#x7DE 11 249)
      (#x7ED 11 250)
      (#x7F1 11 251)
      (#x7F9 11 252)
      (#x7FC 11 253)
      (#x7D3 11 263)
      (#x7E1 11 264)
      (#x7EE 11 265)
      (#x7EF 11 266)
      (#x7F5 11 267)
      (#x7F6 11 268)
      (#xFFB 12 12)
      (#xFFA 12 14)
      (#xFFE 12 15)
      (#xFFD 12 255)
      (#xFFC 12 269)
      (#xFFF 12 270)))

;; Table 4.132 – Spectrum Huffman codebooks parameters
(defun get-codebook (codebook-number)
  ;; unsigned-cb dimention-of-codebook LAV codebook
  (ecase codebook-number
    (1  (values nil 4 1 *codebook1*))
    (2  (values nil 4 1 *codebook2*))
    (3  (values   t 4 2 *codebook3*))
    (4  (values   t 4 2 *codebook4*))
    (5  (values nil 2 4 *codebook5*))
    (6  (values nil 2 4 *codebook6*))
    (7  (values   t 2 7 *codebook7*))
    (8  (values   t 2 7 *codebook8*))
    (9  (values   t 2 12 *codebook9*))
    (10 (values   t 2 12 *codebook10*))
    (11 (values   t 2 16 #|with ESC 8191|# *codebook11*))))

;; 4.6.3.3 Decoding process
(defun get-wxyz (unsigned? dimention lav index)
  (let ((mod 0)
        (off 0)
        (w 0)
        (x 0)
        (y 0)
        (z 0))
    (if unsigned?
        (setf mod (1+ lav))
      (setf mod (1+ (* 2 lav))
            off lav))

    (when (= dimention 4)
      (setf w (- (floor index (* mod mod mod)) off))
      (decf index (* (+ w off) (* mod mod mod)))
      (setf x (- (floor index (* mod mod)) off))
      (decf index (* (+ x off) (* mod mod))))
    
    (setf y (- (floor index mod) off))
    (decf index (* (+ y off) mod))
    (setf z (- index off))

    (values w x y z)))
